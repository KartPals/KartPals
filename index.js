var qe=Object.create;var he=Object.defineProperty;var Ne=Object.getOwnPropertyDescriptor;var $e=Object.getOwnPropertyNames;var Ve=Object.getPrototypeOf,Ge=Object.prototype.hasOwnProperty;var de=(t=>typeof require<"u"?require:typeof Proxy<"u"?new Proxy(t,{get:(e,r)=>(typeof require<"u"?require:e)[r]}):t)(function(t){if(typeof require<"u")return require.apply(this,arguments);throw Error('Dynamic require of "'+t+'" is not supported')});var Je=(t,e)=>()=>(t&&(e=t(t=0)),e);var M=(t,e)=>()=>(e||t((e={exports:{}}).exports,e),e.exports);var Ke=(t,e,r,n)=>{if(e&&typeof e=="object"||typeof e=="function")for(let s of $e(e))!Ge.call(t,s)&&s!==r&&he(t,s,{get:()=>e[s],enumerable:!(n=Ne(e,s))||n.enumerable});return t};var Y=(t,e,r)=>(r=t!=null?qe(Ve(t)):{},Ke(e||!t||!t.__esModule?he(r,"default",{value:t,enumerable:!0}):r,t));var _=Je(()=>{});var me=M((Fr,pe)=>{_();var W=1e3,z=W*60,j=z*60,D=j*24,Ye=D*7,Ze=D*365.25;pe.exports=function(t,e){e=e||{};var r=typeof t;if(r==="string"&&t.length>0)return Qe(t);if(r==="number"&&isFinite(t))return e.long?er(t):Xe(t);throw new Error("val is not a non-empty string or a valid number. val="+JSON.stringify(t))};function Qe(t){if(t=String(t),!(t.length>100)){var e=/^(-?(?:\d+)?\.?\d+) *(milliseconds?|msecs?|ms|seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|weeks?|w|years?|yrs?|y)?$/i.exec(t);if(e){var r=parseFloat(e[1]),n=(e[2]||"ms").toLowerCase();switch(n){case"years":case"year":case"yrs":case"yr":case"y":return r*Ze;case"weeks":case"week":case"w":return r*Ye;case"days":case"day":case"d":return r*D;case"hours":case"hour":case"hrs":case"hr":case"h":return r*j;case"minutes":case"minute":case"mins":case"min":case"m":return r*z;case"seconds":case"second":case"secs":case"sec":case"s":return r*W;case"milliseconds":case"millisecond":case"msecs":case"msec":case"ms":return r;default:return}}}}function Xe(t){var e=Math.abs(t);return e>=D?Math.round(t/D)+"d":e>=j?Math.round(t/j)+"h":e>=z?Math.round(t/z)+"m":e>=W?Math.round(t/W)+"s":t+"ms"}function er(t){var e=Math.abs(t);return e>=D?Z(t,e,D,"day"):e>=j?Z(t,e,j,"hour"):e>=z?Z(t,e,z,"minute"):e>=W?Z(t,e,W,"second"):t+" ms"}function Z(t,e,r,n){var s=e>=r*1.5;return Math.round(t/r)+" "+n+(s?"s":"")}});var ye=M((Er,ve)=>{_();function rr(t){r.debug=r,r.default=r,r.coerce=c,r.disable=h,r.enable=s,r.enabled=p,r.humanize=me(),r.destroy=v,Object.keys(t).forEach(f=>{r[f]=t[f]}),r.names=[],r.skips=[],r.formatters={};function e(f){let i=0;for(let d=0;d<f.length;d++)i=(i<<5)-i+f.charCodeAt(d),i|=0;return r.colors[Math.abs(i)%r.colors.length]}r.selectColor=e;function r(f){let i,d=null,a,m;function y(...b){if(!y.enabled)return;let o=y,l=Number(new Date),g=l-(i||l);o.diff=g,o.prev=i,o.curr=l,i=l,b[0]=r.coerce(b[0]),typeof b[0]!="string"&&b.unshift("%O");let w=0;b[0]=b[0].replace(/%([a-zA-Z%])/g,(C,T)=>{if(C==="%%")return"%";w++;let E=r.formatters[T];if(typeof E=="function"){let I=b[w];C=E.call(o,I),b.splice(w,1),w--}return C}),r.formatArgs.call(o,b),(o.log||r.log).apply(o,b)}return y.namespace=f,y.useColors=r.useColors(),y.color=r.selectColor(f),y.extend=n,y.destroy=r.destroy,Object.defineProperty(y,"enabled",{enumerable:!0,configurable:!1,get:()=>d!==null?d:(a!==r.namespaces&&(a=r.namespaces,m=r.enabled(f)),m),set:b=>{d=b}}),typeof r.init=="function"&&r.init(y),y}function n(f,i){let d=r(this.namespace+(typeof i>"u"?":":i)+f);return d.log=this.log,d}function s(f){r.save(f),r.namespaces=f,r.names=[],r.skips=[];let i=(typeof f=="string"?f:"").trim().replace(/\s+/g,",").split(",").filter(Boolean);for(let d of i)d[0]==="-"?r.skips.push(d.slice(1)):r.names.push(d)}function u(f,i){let d=0,a=0,m=-1,y=0;for(;d<f.length;)if(a<i.length&&(i[a]===f[d]||i[a]==="*"))i[a]==="*"?(m=a,y=d,a++):(d++,a++);else if(m!==-1)a=m+1,y++,d=y;else return!1;for(;a<i.length&&i[a]==="*";)a++;return a===i.length}function h(){let f=[...r.names,...r.skips.map(i=>"-"+i)].join(",");return r.enable(""),f}function p(f){for(let i of r.skips)if(u(f,i))return!1;for(let i of r.names)if(u(f,i))return!0;return!1}function c(f){return f instanceof Error?f.stack||f.message:f}function v(){console.warn("Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`.")}return r.enable(r.load()),r}ve.exports=rr});var we=M((B,Q)=>{_();B.formatArgs=nr;B.save=or;B.load=sr;B.useColors=tr;B.storage=ir();B.destroy=(()=>{let t=!1;return()=>{t||(t=!0,console.warn("Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`."))}})();B.colors=["#0000CC","#0000FF","#0033CC","#0033FF","#0066CC","#0066FF","#0099CC","#0099FF","#00CC00","#00CC33","#00CC66","#00CC99","#00CCCC","#00CCFF","#3300CC","#3300FF","#3333CC","#3333FF","#3366CC","#3366FF","#3399CC","#3399FF","#33CC00","#33CC33","#33CC66","#33CC99","#33CCCC","#33CCFF","#6600CC","#6600FF","#6633CC","#6633FF","#66CC00","#66CC33","#9900CC","#9900FF","#9933CC","#9933FF","#99CC00","#99CC33","#CC0000","#CC0033","#CC0066","#CC0099","#CC00CC","#CC00FF","#CC3300","#CC3333","#CC3366","#CC3399","#CC33CC","#CC33FF","#CC6600","#CC6633","#CC9900","#CC9933","#CCCC00","#CCCC33","#FF0000","#FF0033","#FF0066","#FF0099","#FF00CC","#FF00FF","#FF3300","#FF3333","#FF3366","#FF3399","#FF33CC","#FF33FF","#FF6600","#FF6633","#FF9900","#FF9933","#FFCC00","#FFCC33"];function tr(){if(typeof window<"u"&&window.process&&(window.process.type==="renderer"||window.process.__nwjs))return!0;if(typeof navigator<"u"&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/(edge|trident)\/(\d+)/))return!1;let t;return typeof document<"u"&&document.documentElement&&document.documentElement.style&&document.documentElement.style.WebkitAppearance||typeof window<"u"&&window.console&&(window.console.firebug||window.console.exception&&window.console.table)||typeof navigator<"u"&&navigator.userAgent&&(t=navigator.userAgent.toLowerCase().match(/firefox\/(\d+)/))&&parseInt(t[1],10)>=31||typeof navigator<"u"&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/applewebkit\/(\d+)/)}function nr(t){if(t[0]=(this.useColors?"%c":"")+this.namespace+(this.useColors?" %c":" ")+t[0]+(this.useColors?"%c ":" ")+"+"+Q.exports.humanize(this.diff),!this.useColors)return;let e="color: "+this.color;t.splice(1,0,e,"color: inherit");let r=0,n=0;t[0].replace(/%[a-zA-Z%]/g,s=>{s!=="%%"&&(r++,s==="%c"&&(n=r))}),t.splice(n,0,e)}B.log=console.debug||console.log||(()=>{});function or(t){try{t?B.storage.setItem("debug",t):B.storage.removeItem("debug")}catch{}}function sr(){let t;try{t=B.storage.getItem("debug")||B.storage.getItem("DEBUG")}catch{}return!t&&typeof process<"u"&&"env"in process&&(t=process.env.DEBUG),t}function ir(){try{return localStorage}catch{}}Q.exports=ye()(B);var{formatters:ar}=Q.exports;ar.j=function(t){try{return JSON.stringify(t)}catch(e){return"[UnexpectedJSONParseError]: "+e.message}}});var Ce=M((Br,ie)=>{"use strict";_();var cr=Object.prototype.hasOwnProperty,k="~";function V(){}Object.create&&(V.prototype=Object.create(null),new V().__proto__||(k=!1));function ur(t,e,r){this.fn=t,this.context=e,this.once=r||!1}function ge(t,e,r,n,s){if(typeof r!="function")throw new TypeError("The listener must be a function");var u=new ur(r,n||t,s),h=k?k+e:e;return t._events[h]?t._events[h].fn?t._events[h]=[t._events[h],u]:t._events[h].push(u):(t._events[h]=u,t._eventsCount++),t}function X(t,e){--t._eventsCount===0?t._events=new V:delete t._events[e]}function x(){this._events=new V,this._eventsCount=0}x.prototype.eventNames=function(){var e=[],r,n;if(this._eventsCount===0)return e;for(n in r=this._events)cr.call(r,n)&&e.push(k?n.slice(1):n);return Object.getOwnPropertySymbols?e.concat(Object.getOwnPropertySymbols(r)):e};x.prototype.listeners=function(e){var r=k?k+e:e,n=this._events[r];if(!n)return[];if(n.fn)return[n.fn];for(var s=0,u=n.length,h=new Array(u);s<u;s++)h[s]=n[s].fn;return h};x.prototype.listenerCount=function(e){var r=k?k+e:e,n=this._events[r];return n?n.fn?1:n.length:0};x.prototype.emit=function(e,r,n,s,u,h){var p=k?k+e:e;if(!this._events[p])return!1;var c=this._events[p],v=arguments.length,f,i;if(c.fn){switch(c.once&&this.removeListener(e,c.fn,void 0,!0),v){case 1:return c.fn.call(c.context),!0;case 2:return c.fn.call(c.context,r),!0;case 3:return c.fn.call(c.context,r,n),!0;case 4:return c.fn.call(c.context,r,n,s),!0;case 5:return c.fn.call(c.context,r,n,s,u),!0;case 6:return c.fn.call(c.context,r,n,s,u,h),!0}for(i=1,f=new Array(v-1);i<v;i++)f[i-1]=arguments[i];c.fn.apply(c.context,f)}else{var d=c.length,a;for(i=0;i<d;i++)switch(c[i].once&&this.removeListener(e,c[i].fn,void 0,!0),v){case 1:c[i].fn.call(c[i].context);break;case 2:c[i].fn.call(c[i].context,r);break;case 3:c[i].fn.call(c[i].context,r,n);break;case 4:c[i].fn.call(c[i].context,r,n,s);break;default:if(!f)for(a=1,f=new Array(v-1);a<v;a++)f[a-1]=arguments[a];c[i].fn.apply(c[i].context,f)}}return!0};x.prototype.on=function(e,r,n){return ge(this,e,r,n,!1)};x.prototype.once=function(e,r,n){return ge(this,e,r,n,!0)};x.prototype.removeListener=function(e,r,n,s){var u=k?k+e:e;if(!this._events[u])return this;if(!r)return X(this,u),this;var h=this._events[u];if(h.fn)h.fn===r&&(!s||h.once)&&(!n||h.context===n)&&X(this,u);else{for(var p=0,c=[],v=h.length;p<v;p++)(h[p].fn!==r||s&&!h[p].once||n&&h[p].context!==n)&&c.push(h[p]);c.length?this._events[u]=c.length===1?c[0]:c:X(this,u)}return this};x.prototype.removeAllListeners=function(e){var r;return e?(r=k?k+e:e,this._events[r]&&X(this,r)):(this._events=new V,this._eventsCount=0),this};x.prototype.off=x.prototype.removeListener;x.prototype.addListener=x.prototype.on;x.prefixed=k;x.EventEmitter=x;typeof ie<"u"&&(ie.exports=x)});var be=M((Lr,_e)=>{_();_e.exports={}});var ce=M((re,Fe)=>{_();(function(t,e){typeof re=="object"?Fe.exports=re=e():typeof define=="function"&&define.amd?define([],e):t.CryptoJS=e()})(re,function(){var t=t||function(e,r){var n;if(typeof window<"u"&&window.crypto&&(n=window.crypto),typeof self<"u"&&self.crypto&&(n=self.crypto),typeof globalThis<"u"&&globalThis.crypto&&(n=globalThis.crypto),!n&&typeof window<"u"&&window.msCrypto&&(n=window.msCrypto),!n&&typeof globalThis<"u"&&globalThis.crypto&&(n=globalThis.crypto),!n&&typeof de=="function")try{n=be()}catch{}var s=function(){if(n){if(typeof n.getRandomValues=="function")try{return n.getRandomValues(new Uint32Array(1))[0]}catch{}if(typeof n.randomBytes=="function")try{return n.randomBytes(4).readInt32LE()}catch{}}throw new Error("Native crypto module could not be used to get secure random number.")},u=Object.create||function(){function o(){}return function(l){var g;return o.prototype=l,g=new o,o.prototype=null,g}}(),h={},p=h.lib={},c=p.Base=function(){return{extend:function(o){var l=u(this);return o&&l.mixIn(o),(!l.hasOwnProperty("init")||this.init===l.init)&&(l.init=function(){l.$super.init.apply(this,arguments)}),l.init.prototype=l,l.$super=this,l},create:function(){var o=this.extend();return o.init.apply(o,arguments),o},init:function(){},mixIn:function(o){for(var l in o)o.hasOwnProperty(l)&&(this[l]=o[l]);o.hasOwnProperty("toString")&&(this.toString=o.toString)},clone:function(){return this.init.prototype.extend(this)}}}(),v=p.WordArray=c.extend({init:function(o,l){o=this.words=o||[],l!=r?this.sigBytes=l:this.sigBytes=o.length*4},toString:function(o){return(o||i).stringify(this)},concat:function(o){var l=this.words,g=o.words,w=this.sigBytes,F=o.sigBytes;if(this.clamp(),w%4)for(var C=0;C<F;C++){var T=g[C>>>2]>>>24-C%4*8&255;l[w+C>>>2]|=T<<24-(w+C)%4*8}else for(var E=0;E<F;E+=4)l[w+E>>>2]=g[E>>>2];return this.sigBytes+=F,this},clamp:function(){var o=this.words,l=this.sigBytes;o[l>>>2]&=4294967295<<32-l%4*8,o.length=e.ceil(l/4)},clone:function(){var o=c.clone.call(this);return o.words=this.words.slice(0),o},random:function(o){for(var l=[],g=0;g<o;g+=4)l.push(s());return new v.init(l,o)}}),f=h.enc={},i=f.Hex={stringify:function(o){for(var l=o.words,g=o.sigBytes,w=[],F=0;F<g;F++){var C=l[F>>>2]>>>24-F%4*8&255;w.push((C>>>4).toString(16)),w.push((C&15).toString(16))}return w.join("")},parse:function(o){for(var l=o.length,g=[],w=0;w<l;w+=2)g[w>>>3]|=parseInt(o.substr(w,2),16)<<24-w%8*4;return new v.init(g,l/2)}},d=f.Latin1={stringify:function(o){for(var l=o.words,g=o.sigBytes,w=[],F=0;F<g;F++){var C=l[F>>>2]>>>24-F%4*8&255;w.push(String.fromCharCode(C))}return w.join("")},parse:function(o){for(var l=o.length,g=[],w=0;w<l;w++)g[w>>>2]|=(o.charCodeAt(w)&255)<<24-w%4*8;return new v.init(g,l)}},a=f.Utf8={stringify:function(o){try{return decodeURIComponent(escape(d.stringify(o)))}catch{throw new Error("Malformed UTF-8 data")}},parse:function(o){return d.parse(unescape(encodeURIComponent(o)))}},m=p.BufferedBlockAlgorithm=c.extend({reset:function(){this._data=new v.init,this._nDataBytes=0},_append:function(o){typeof o=="string"&&(o=a.parse(o)),this._data.concat(o),this._nDataBytes+=o.sigBytes},_process:function(o){var l,g=this._data,w=g.words,F=g.sigBytes,C=this.blockSize,T=C*4,E=F/T;o?E=e.ceil(E):E=e.max((E|0)-this._minBufferSize,0);var I=E*C,K=e.min(I*4,F);if(I){for(var $=0;$<I;$+=C)this._doProcessBlock(w,$);l=w.splice(0,I),g.sigBytes-=K}return new v.init(l,K)},clone:function(){var o=c.clone.call(this);return o._data=this._data.clone(),o},_minBufferSize:0}),y=p.Hasher=m.extend({cfg:c.extend(),init:function(o){this.cfg=this.cfg.extend(o),this.reset()},reset:function(){m.reset.call(this),this._doReset()},update:function(o){return this._append(o),this._process(),this},finalize:function(o){o&&this._append(o);var l=this._doFinalize();return l},blockSize:512/32,_createHelper:function(o){return function(l,g){return new o.init(g).finalize(l)}},_createHmacHelper:function(o){return function(l,g){return new b.HMAC.init(o,g).finalize(l)}}}),b=h.algo={};return h}(Math);return t})});var Ee=M((te,xe)=>{_();(function(t,e){typeof te=="object"?xe.exports=te=e(ce()):typeof define=="function"&&define.amd?define(["./core"],e):e(t.CryptoJS)})(te,function(t){return function(e){var r=t,n=r.lib,s=n.WordArray,u=n.Hasher,h=r.algo,p=[],c=[];(function(){function i(y){for(var b=e.sqrt(y),o=2;o<=b;o++)if(!(y%o))return!1;return!0}function d(y){return(y-(y|0))*4294967296|0}for(var a=2,m=0;m<64;)i(a)&&(m<8&&(p[m]=d(e.pow(a,1/2))),c[m]=d(e.pow(a,1/3)),m++),a++})();var v=[],f=h.SHA256=u.extend({_doReset:function(){this._hash=new s.init(p.slice(0))},_doProcessBlock:function(i,d){for(var a=this._hash.words,m=a[0],y=a[1],b=a[2],o=a[3],l=a[4],g=a[5],w=a[6],F=a[7],C=0;C<64;C++){if(C<16)v[C]=i[d+C]|0;else{var T=v[C-15],E=(T<<25|T>>>7)^(T<<14|T>>>18)^T>>>3,I=v[C-2],K=(I<<15|I>>>17)^(I<<13|I>>>19)^I>>>10;v[C]=E+v[C-7]+K+v[C-16]}var $=l&g^~l&w,Ue=m&y^m&b^y&b,We=(m<<30|m>>>2)^(m<<19|m>>>13)^(m<<10|m>>>22),ze=(l<<26|l>>>6)^(l<<21|l>>>11)^(l<<7|l>>>25),fe=F+ze+$+c[C]+v[C],je=We+Ue;F=w,w=g,g=l,l=o+fe|0,o=b,b=y,y=m,m=fe+je|0}a[0]=a[0]+m|0,a[1]=a[1]+y|0,a[2]=a[2]+b|0,a[3]=a[3]+o|0,a[4]=a[4]+l|0,a[5]=a[5]+g|0,a[6]=a[6]+w|0,a[7]=a[7]+F|0},_doFinalize:function(){var i=this._data,d=i.words,a=this._nDataBytes*8,m=i.sigBytes*8;return d[m>>>5]|=128<<24-m%32,d[(m+64>>>9<<4)+14]=e.floor(a/4294967296),d[(m+64>>>9<<4)+15]=a,i.sigBytes=d.length*4,this._process(),this._hash},clone:function(){var i=u.clone.call(this);return i._hash=this._hash.clone(),i}});r.SHA256=u._createHelper(f),r.HmacSHA256=u._createHmacHelper(f)}(Math),t.SHA256})});var Se=M((ne,ke)=>{_();(function(t,e){typeof ne=="object"?ke.exports=ne=e(ce()):typeof define=="function"&&define.amd?define(["./core"],e):e(t.CryptoJS)})(ne,function(t){return function(){var e=t,r=e.lib,n=r.WordArray,s=e.enc,u=s.Base64={stringify:function(p){var c=p.words,v=p.sigBytes,f=this._map;p.clamp();for(var i=[],d=0;d<v;d+=3)for(var a=c[d>>>2]>>>24-d%4*8&255,m=c[d+1>>>2]>>>24-(d+1)%4*8&255,y=c[d+2>>>2]>>>24-(d+2)%4*8&255,b=a<<16|m<<8|y,o=0;o<4&&d+o*.75<v;o++)i.push(f.charAt(b>>>6*(3-o)&63));var l=f.charAt(64);if(l)for(;i.length%4;)i.push(l);return i.join("")},parse:function(p){var c=p.length,v=this._map,f=this._reverseMap;if(!f){f=this._reverseMap=[];for(var i=0;i<v.length;i++)f[v.charCodeAt(i)]=i}var d=v.charAt(64);if(d){var a=p.indexOf(d);a!==-1&&(c=a)}return h(p,c,f)},_map:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/="};function h(p,c,v){for(var f=[],i=0,d=0;d<c;d++)if(d%4){var a=v[p.charCodeAt(d-1)]<<d%4*2,m=v[p.charCodeAt(d)]>>>6-d%4*2,y=a|m;f[i>>>2]|=y<<24-i%4*8,i++}return n.create(f,i)}}(),t.enc.Base64})});_();_();_();_();var Be=Y(we());_();var ee=Y(Ce(),1);_();var q=null;typeof WebSocket<"u"?q=WebSocket:typeof MozWebSocket<"u"?q=MozWebSocket:typeof globalThis<"u"?q=globalThis.WebSocket||globalThis.MozWebSocket:typeof window<"u"?q=window.WebSocket||window.MozWebSocket:typeof self<"u"&&(q=self.WebSocket||self.MozWebSocket);var ae=q;var ue=Y(Ee()),le=Y(Se());function lr(t,e,r){let n=le.default.stringify((0,ue.default)(r+t));return le.default.stringify((0,ue.default)(n+e))}var G=(0,Be.default)("obs-websocket-js"),N=class extends Error{constructor(t,e){super(e),this.code=t}},Ae=class oe extends ee.default{static requestCounter=1;static generateMessageId(){return String(oe.requestCounter++)}_identified=!1;internalListeners=new ee.default;socket;get identified(){return this._identified}async connect(e="ws://127.0.0.1:4455",r,n={}){this.socket&&await this.disconnect();try{let s=this.internalEventPromise("ConnectionClosed"),u=this.internalEventPromise("ConnectionError");return await Promise.race([(async()=>{let h=await this.createConnection(e);return this.emit("Hello",h),this.identify(h,r,n)})(),new Promise((h,p)=>{u.then(c=>{c.message&&p(c)}),s.then(c=>{p(c)})})])}catch(s){throw await this.disconnect(),s}}async disconnect(){if(!this.socket||this.socket.readyState===ae.CLOSED)return;let e=this.internalEventPromise("ConnectionClosed");this.socket.close(),await e}async reidentify(e){let r=this.internalEventPromise("op:2");return await this.message(3,e),r}async call(e,r){let n=oe.generateMessageId(),s=this.internalEventPromise(`res:${n}`);await this.message(6,{requestId:n,requestType:e,requestData:r});let{requestStatus:u,responseData:h}=await s;if(!u.result)throw new N(u.code,u.comment);return h}async callBatch(e,r={}){let n=oe.generateMessageId(),s=this.internalEventPromise(`res:${n}`);await this.message(8,{requestId:n,requests:e,...r});let{results:u}=await s;return u}cleanup(){this.socket&&(this.socket.onopen=null,this.socket.onmessage=null,this.socket.onerror=null,this.socket.onclose=null,this.socket=void 0,this._identified=!1,this.internalListeners.removeAllListeners())}async createConnection(e){var r;let n=this.internalEventPromise("ConnectionOpened"),s=this.internalEventPromise("op:0");this.socket=new ae(e,this.protocol),this.socket.onopen=this.onOpen.bind(this),this.socket.onmessage=this.onMessage.bind(this),this.socket.onerror=this.onError.bind(this),this.socket.onclose=this.onClose.bind(this),await n;let u=(r=this.socket)==null?void 0:r.protocol;if(!u)throw new N(-1,"Server sent no subprotocol");if(u!==this.protocol)throw new N(-1,"Server sent an invalid subprotocol");return s}async identify({authentication:e,rpcVersion:r,...n},s,u={}){let h={rpcVersion:r,...u};e&&s&&(h.authentication=lr(e.salt,e.challenge,s));let p=this.internalEventPromise("op:2");await this.message(1,h);let c=await p;return this._identified=!0,this.emit("Identified",c),{rpcVersion:r,...n,...c}}async message(e,r){if(!this.socket)throw new Error("Not connected");if(!this.identified&&e!==1)throw new Error("Socket not identified");let n=await this.encodeMessage({op:e,d:r});this.socket.send(n)}async internalEventPromise(e){return new Promise(r=>{this.internalListeners.once(e,r)})}onOpen(e){G("socket.open"),this.emit("ConnectionOpened"),this.internalListeners.emit("ConnectionOpened",e)}async onMessage(e){try{let{op:r,d:n}=await this.decodeMessage(e.data);if(G("socket.message: %d %j",r,n),r===void 0||n===void 0)return;switch(r){case 5:{let{eventType:s,eventData:u}=n;this.emit(s,u);return}case 7:case 9:{let{requestId:s}=n;this.internalListeners.emit(`res:${s}`,n);return}default:this.internalListeners.emit(`op:${r}`,n)}}catch(r){G("error handling message: %o",r)}}onError(e){G("socket.error: %o",e);let r=new N(-1,e.message);this.emit("ConnectionError",r),this.internalListeners.emit("ConnectionError",r)}onClose(e){G("socket.close: %s (%d)",e.reason,e.code);let r=new N(e.code,e.reason);this.emit("ConnectionClosed",r),this.internalListeners.emit("ConnectionClosed",r),this.cleanup()}};typeof exports<"u"&&Object.defineProperty(exports,"__esModule",{value:!0});var Ie=class extends Ae{protocol="obswebsocket.json";async encodeMessage(t){return JSON.stringify(t)}async decodeMessage(t){return JSON.parse(t)}};var Pe=new Ie;_();var fr={withStackTrace:!1},Le=(t,e,r=fr)=>{let n=e.isOk()?{type:"Ok",value:e.value}:{type:"Err",value:e.error},s=r.withStackTrace?new Error().stack:void 0;return{data:n,message:t,stack:s}};function U(t,e,r,n){function s(u){return u instanceof r?u:new r(function(h){h(u)})}return new(r||(r=Promise))(function(u,h){function p(f){try{v(n.next(f))}catch(i){h(i)}}function c(f){try{v(n.throw(f))}catch(i){h(i)}}function v(f){f.done?u(f.value):s(f.value).then(p,c)}v((n=n.apply(t,e||[])).next())})}function Oe(t){var e=typeof Symbol=="function"&&Symbol.iterator,r=e&&t[e],n=0;if(r)return r.call(t);if(t&&typeof t.length=="number")return{next:function(){return t&&n>=t.length&&(t=void 0),{value:t&&t[n++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}function R(t){return this instanceof R?(this.v=t,this):new R(t)}function Te(t,e,r){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var n=r.apply(t,e||[]),s,u=[];return s=Object.create((typeof AsyncIterator=="function"?AsyncIterator:Object).prototype),p("next"),p("throw"),p("return",h),s[Symbol.asyncIterator]=function(){return this},s;function h(a){return function(m){return Promise.resolve(m).then(a,i)}}function p(a,m){n[a]&&(s[a]=function(y){return new Promise(function(b,o){u.push([a,y,b,o])>1||c(a,y)})},m&&(s[a]=m(s[a])))}function c(a,m){try{v(n[a](m))}catch(y){d(u[0][3],y)}}function v(a){a.value instanceof R?Promise.resolve(a.value.v).then(f,i):d(u[0][2],a)}function f(a){c("next",a)}function i(a){c("throw",a)}function d(a,m){a(m),u.shift(),u.length&&c(u[0][0],u[0][1])}}function hr(t){var e,r;return e={},n("next"),n("throw",function(s){throw s}),n("return"),e[Symbol.iterator]=function(){return this},e;function n(s,u){e[s]=t[s]?function(h){return(r=!r)?{value:R(t[s](h)),done:!1}:u?u(h):h}:u}}function dr(t){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var e=t[Symbol.asyncIterator],r;return e?e.call(t):(t=typeof Oe=="function"?Oe(t):t[Symbol.iterator](),r={},n("next"),n("throw"),n("return"),r[Symbol.asyncIterator]=function(){return this},r);function n(u){r[u]=t[u]&&function(h){return new Promise(function(p,c){h=t[u](h),s(p,c,h.done,h.value)})}}function s(u,h,p,c){Promise.resolve(c).then(function(v){u({value:v,done:p})},h)}}var O=class t{constructor(e){this._promise=e}static fromSafePromise(e){let r=e.then(n=>new P(n));return new t(r)}static fromPromise(e,r){let n=e.then(s=>new P(s)).catch(s=>new A(r(s)));return new t(n)}static fromThrowable(e,r){return(...n)=>new t(U(this,void 0,void 0,function*(){try{return new P(yield e(...n))}catch(s){return new A(r?r(s):s)}}))}static combine(e){return pr(e)}static combineWithAllErrors(e){return mr(e)}map(e){return new t(this._promise.then(r=>U(this,void 0,void 0,function*(){return r.isErr()?new A(r.error):new P(yield e(r.value))})))}andThrough(e){return new t(this._promise.then(r=>U(this,void 0,void 0,function*(){if(r.isErr())return new A(r.error);let n=yield e(r.value);return n.isErr()?new A(n.error):new P(r.value)})))}andTee(e){return new t(this._promise.then(r=>U(this,void 0,void 0,function*(){if(r.isErr())return new A(r.error);try{yield e(r.value)}catch{}return new P(r.value)})))}orTee(e){return new t(this._promise.then(r=>U(this,void 0,void 0,function*(){if(r.isOk())return new P(r.value);try{yield e(r.error)}catch{}return new A(r.error)})))}mapErr(e){return new t(this._promise.then(r=>U(this,void 0,void 0,function*(){return r.isOk()?new P(r.value):new A(yield e(r.error))})))}andThen(e){return new t(this._promise.then(r=>{if(r.isErr())return new A(r.error);let n=e(r.value);return n instanceof t?n._promise:n}))}orElse(e){return new t(this._promise.then(r=>U(this,void 0,void 0,function*(){return r.isErr()?e(r.error):new P(r.value)})))}match(e,r){return this._promise.then(n=>n.match(e,r))}unwrapOr(e){return this._promise.then(r=>r.unwrapOr(e))}safeUnwrap(){return Te(this,arguments,function*(){return yield R(yield R(yield*hr(dr(yield R(this._promise.then(r=>r.safeUnwrap()))))))})}then(e,r){return this._promise.then(e,r)}[Symbol.asyncIterator](){return Te(this,arguments,function*(){let r=yield R(this._promise);return r.isErr()&&(yield yield R(se(r.error))),yield R(r.value)})}};function se(t){return new O(Promise.resolve(new A(t)))}var rt=O.fromPromise,tt=O.fromSafePromise,nt=O.fromThrowable,Re=t=>{let e=H([]);for(let r of t)if(r.isErr()){e=L(r.error);break}else e.map(n=>n.push(r.value));return e},pr=t=>O.fromSafePromise(Promise.all(t)).andThen(Re),Me=t=>{let e=H([]);for(let r of t)r.isErr()&&e.isErr()?e.error.push(r.error):r.isErr()&&e.isOk()?e=L([r.error]):r.isOk()&&e.isOk()&&e.value.push(r.value);return e},mr=t=>O.fromSafePromise(Promise.all(t)).andThen(Me),J;(function(t){function e(s,u){return(...h)=>{try{let p=s(...h);return H(p)}catch(p){return L(u?u(p):p)}}}t.fromThrowable=e;function r(s){return Re(s)}t.combine=r;function n(s){return Me(s)}t.combineWithAllErrors=n})(J||(J={}));function H(t){return new P(t)}function L(t){return new A(t)}var P=class{constructor(e){this.value=e}isOk(){return!0}isErr(){return!this.isOk()}map(e){return H(e(this.value))}mapErr(e){return H(this.value)}andThen(e){return e(this.value)}andThrough(e){return e(this.value).map(r=>this.value)}andTee(e){try{e(this.value)}catch{}return H(this.value)}orTee(e){return H(this.value)}orElse(e){return H(this.value)}asyncAndThen(e){return e(this.value)}asyncAndThrough(e){return e(this.value).map(()=>this.value)}asyncMap(e){return O.fromSafePromise(e(this.value))}unwrapOr(e){return this.value}match(e,r){return e(this.value)}safeUnwrap(){let e=this.value;return function*(){return e}()}_unsafeUnwrap(e){return this.value}_unsafeUnwrapErr(e){throw Le("Called `_unsafeUnwrapErr` on an Ok",this,e)}*[Symbol.iterator](){return this.value}},A=class{constructor(e){this.error=e}isOk(){return!1}isErr(){return!this.isOk()}map(e){return L(this.error)}mapErr(e){return L(e(this.error))}andThrough(e){return L(this.error)}andTee(e){return L(this.error)}orTee(e){try{e(this.error)}catch{}return L(this.error)}andThen(e){return L(this.error)}orElse(e){return e(this.error)}asyncAndThen(e){return se(this.error)}asyncAndThrough(e){return se(this.error)}asyncMap(e){return se(this.error)}unwrapOr(e){return e}match(e,r){return r(this.error)}safeUnwrap(){let e=this.error;return function*(){throw yield L(e),new Error("Do not use this generator out of `safeTry`")}()}_unsafeUnwrap(e){throw Le("Called `_unsafeUnwrap` on an Err",this,e)}_unsafeUnwrapErr(e){return this.error}*[Symbol.iterator](){let e=this;return yield e,e}},ot=J.fromThrowable;var He=Pe;function vr(){return O.fromPromise(He.connect("ws://localhost:4455"),t=>t instanceof Error?t:new Error(String(t))).map(t=>(console.log("[OBS] Connection attempt finished"),console.log("[OBS] Connected to OBS!"),t)).mapErr(t=>(console.error("[OBS] Connection failed:",t),t instanceof Error?t:new Error(String(t))))}function yr(t){return O.fromPromise(He.call("SetInputSettings",{inputName:"KillsText",inputSettings:{text:`Kills: ${t}`}}),e=>e instanceof Error?e:new Error(String(e))).map(()=>console.log("[OBS] Updated kills text to:",t)).mapErr(e=>(console.error("[OBS] Failed to update kills text:",e),e instanceof Error?e:new Error(String(e))))}vr().then(t=>{t.match(()=>Cr(),e=>console.error("OBS not detected:",e))});var De={};function wr(){chrome.runtime.sendMessage({type:"INJECT_BFETCH_OVERRIDE"});function t(e){if(e.data&&e.data.type==="BYTEBREW_LOG_PAYLOAD"){console.log("[Debug] Received payload:",e.data.payload);let r=`${Math.random().toString(36).substring(2,9)}_${Date.now()}`;De[r]=e.data.payload}}window.addEventListener("message",t)}wr();function gr(){return J.fromThrowable(()=>{let t=0;return Object.values(De).forEach(r=>{if(r&&typeof r=="object"&&r.externalData&&typeof r.externalData=="object"){let n=r.externalData.eventType,s=r.externalData.value;if(typeof s=="string"&&s.includes("=")){let[u,h]=s.split("=");n==="destroyed_human"&&u==="weapon"&&h&&t++}}}),t},t=>t instanceof Error?t:new Error(String(t)))().map(t=>(globalThis.__lastLoggedKills!==t&&(console.log("[Game] Current kills:",t),globalThis.__lastLoggedKills=t),t)).mapErr(t=>t instanceof Error?t:new Error(String(t)))}function Cr(){let t=0;setInterval(()=>{gr().map(e=>{e>t&&(console.log(`[Listener] Kill count increased: ${t} -> ${e}`),t=e,yr(e).mapErr(r=>{console.error("[Listener] Failed to update kills text:",r)}))}).mapErr(e=>{console.error("[Listener] Failed to get kills from game:",e)})},1e3)}
//# sourceMappingURL=index.js.map
